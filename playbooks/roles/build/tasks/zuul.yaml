---

- name: set up zuul images tags
  set_fact:
    ZUUL_VERSION: latest

- name: clone zuul git repository
  git:
    repo: "{{ zuul_git_url }}"
    version: "{{ zuul_git_branch }}"
    dest: /opt/git/zuul
    accept_hostkey: yes
    force: true

- name: build zuul docker images
  command: "docker build --target zuul-{{ component }} -t {{ ZUUL_DOCKERREPO }}/zuul-{{ component }}:{{ ZUUL_VERSION }} ."
  args:
    chdir: /opt/git/zuul
